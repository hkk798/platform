<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>æ¸¸å…‰é˜ - çƒ­é—¨æ¦œå•</title>
    <link th:href="@{/css/bootstrap.min.css}" rel="stylesheet">
    <style>
        body { background-color: #121212; color: #e0e0e0; }
        .card { background-color: #1e1e1e; border: 1px solid #333; transition: transform 0.2s; }
        .card:hover { transform: translateY(-5px); border-color: #0d6efd; }
        .navbar { background-color: #000 !important; border-bottom: 1px solid #333; }
        .section-title { border-left: 5px solid #ffc107; padding-left: 15px; margin-bottom: 20px; color: white; }
    </style>
</head>
<body>

<nav class="navbar navbar-expand-lg navbar-dark mb-4">
    <div class="container-fluid">
        <a class="navbar-brand text-warning fw-bold" href="/">ğŸ† æ¸¸å…‰é˜æ’è¡Œæ¦œ</a>
        <div class="d-flex align-items-center">
            <div th:if="${session.currentUser == null}">
                <a href="/login" class="btn btn-outline-secondary me-2">ç™»å½•</a>
                <a href="/register" class="btn btn-primary">æ³¨å†Œ</a>
            </div>
            <div th:if="${session.currentUser != null}" class="dropdown">
                <a href="/cart" class="btn btn-outline-warning me-3">ğŸ›’ è´­ç‰©è½¦</a>
                <button class="btn btn-dark border-secondary dropdown-toggle" type="button" id="userMenu" data-bs-toggle="dropdown">
                    ğŸ‘¤ <span th:text="${session.currentUser.username}">User</span>
                </button>
                <ul class="dropdown-menu dropdown-menu-dark dropdown-menu-end">
                    <li><a class="dropdown-item" href="/logout">é€€å‡ºç™»å½•</a></li>
                </ul>
            </div>
        </div>
    </div>
</nav>

<div class="container">

    <div th:if="${products != null}">
        <h3 class="section-title">ğŸ” æœç´¢ç»“æœ</h3>
        <div class="row row-cols-1 row-cols-md-5 g-4 mb-5">
            <div class="col" th:each="prod : ${products}">
                <div th:replace="~{:: productCard(${prod})}"></div>
            </div>
        </div>
        <hr class="text-secondary">
    </div>

    <div th:if="${topCcuList != null}">
        <h3 class="section-title">ğŸ”¥ çƒ­é—¨æ¸¸ç©æ¦œ (Peak CCU Top 10)</h3>
        <div class="row row-cols-1 row-cols-md-5 g-4 mb-5">
            <div class="col" th:each="prod : ${topCcuList}">
                <div class="card h-100 border-danger">
                    <img th:src="${prod.headerImage}" class="card-img-top" style="height: 120px; object-fit: cover;" onerror="this.style.display='none'">
                    <div class="card-body p-2">
                        <h6 class="card-title text-truncate text-white" th:text="${prod.name}">Name</h6>
                        <div class="d-flex justify-content-between align-items-center mb-2">
                            <span class="badge bg-danger">CCU: <span th:text="${prod.peakCcu}">0</span></span>
                        </div>
                        <a th:href="@{'/product/' + ${prod.productId}}" class="btn btn-sm btn-outline-light w-100 stretched-link">æŸ¥çœ‹è¯¦æƒ…</a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div th:if="${topReviewList != null}">
        <h3 class="section-title" style="border-color: #0d6efd;">ğŸ’¬ çƒ­è®®è¯é¢˜æ¦œ (Most Reviewed Top 10)</h3>
        <div class="row row-cols-1 row-cols-md-5 g-4 mb-5">
            <div class="col" th:each="prod : ${topReviewList}">
                <div class="card h-100 border-info">
                    <img th:src="${prod.headerImage}" class="card-img-top" style="height: 120px; object-fit: cover;" onerror="this.style.display='none'">
                    <div class="card-body p-2">
                        <h6 class="card-title text-truncate text-white" th:text="${prod.name}">Name</h6>
                        <div class="d-flex justify-content-between align-items-center mb-2">
                            <span class="badge bg-info text-dark">Reviews: <span th:text="${prod.numReviewsTotal}">0</span></span>
                        </div>
                        <a th:href="@{'/product/' + ${prod.productId}}" class="btn btn-sm btn-outline-light w-100 stretched-link">æŸ¥çœ‹è¯¦æƒ…</a>
                    </div>
                </div>
            </div>
        </div>
    </div>

</div>

<div th:fragment="productCard(prod)" class="card h-100">
    <img th:src="${prod.headerImage}" class="card-img-top" style="height: 120px; object-fit: cover;">
    <div class="card-body p-2">
        <h6 class="card-title text-truncate text-white" th:text="${prod.name}">Name</h6>
        <p class="text-warning small mb-1">ï¿¥<span th:text="${prod.price}">0</span></p>
        <a th:href="@{'/product/' + ${prod.productId}}" class="btn btn-sm btn-primary w-100 stretched-link">æŸ¥çœ‹</a>
    </div>
</div>

<script th:src="@{/js/bootstrap.bundle.min.js}"></script>
</body>
</html>